<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>TechFix - Laptop Repair & Accessories</title>
    <meta name="description" content="Professional laptop repair services and high-quality laptop accessories. Fast, reliable, and affordable solutions.">
    <meta property="og:title" content="TechFix - Laptop Repair & Accessories">
    <meta property="og:description" content="Professional laptop repair services and high-quality laptop accessories.">
    <meta property="og:type" content="website">
    <!-- Favicon -->
    <link rel="icon" href="data:image/svg+xml,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22><text y=%22.9em%22 font-size=%2290%22>ðŸ’»</text></svg>">
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        primary: {
                            50: '#f0f9ff',
                            100: '#e0f2fe',
                            200: '#bae6fd',
                            300: '#7dd3fc',
                            400: '#38bdf8',
                            500: '#0ea5e9',
                            600: '#0284c7',
                            700: '#0369a1',
                            800: '#075985',
                            900: '#0c4a6e',
                        },
                        secondary: {
                            50: '#fdf4ff',
                            100: '#fae8ff',
                            200: '#f5d0fe',
                            300: '#f0abfc',
                            400: '#e879f9',
                            500: '#d946ef',
                            600: '#c026d3',
                            700: '#a21caf',
                            800: '#86198f',
                            900: '#701a75',
                        }
                    }
                }
            }
        }
    </script>
    <!-- Lucide Icons -->
    <script src="https://unpkg.com/lucide@latest"></script>
    <!-- Supabase JS -->
    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap');
        
        * {
            font-family: 'Inter', sans-serif;
        }
        
        .glass-card {
            background: rgba(255, 255, 255, 0.25);
            backdrop-filter: blur(10px);
            -webkit-backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.18);
        }
        
        .gradient-bg {
            background: linear-gradient(120deg, #e0f2fe 0%, #fae8ff 100%);
        }
        
        .skeleton {
            background: linear-gradient(90deg, #f0f0f0 25%, #e0e0e0 50%, #f0f0f0 75%);
            background-size: 200% 100%;
            animation: loading 1.5s infinite;
        }
        
        @keyframes loading {
            0% {
                background-position: 200% 0;
            }
            100% {
                background-position: -200% 0;
            }
        }
        
        .toast {
            position: fixed;
            bottom: 20px;
            right: 20px;
            padding: 12px 20px;
            background: white;
            border-radius: 8px;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
            transform: translateY(100px);
            opacity: 0;
            transition: all 0.3s ease;
            z-index: 1000;
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .toast.show {
            transform: translateY(0);
            opacity: 1;
        }
        
        .toast.success {
            border-left: 4px solid #10b981;
        }
        
        .toast.error {
            border-left: 4px solid #ef4444;
        }
        
        .toast.info {
            border-left: 4px solid #3b82f6;
        }
        
        .page {
            display: none;
        }
        
        .page.active {
            display: block;
            animation: fadeIn 0.3s ease;
        }
        
        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }
        
        .cart-badge {
            position: absolute;
            top: -8px;
            right: -8px;
            background: #ef4444;
            color: white;
            border-radius: 50%;
            width: 18px;
            height: 18px;
            font-size: 12px;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        
        .status-badge {
            padding: 4px 10px;
            border-radius: 20px;
            font-size: 12px;
            font-weight: 500;
        }
        
        .status-new {
            background: #dbeafe;
            color: #1e40af;
        }
        
        .status-accepted {
            background: #d1fae5;
            color: #065f46;
        }
        
        .status-in_progress {
            background: #fef3c7;
            color: #92400e;
        }
        
        .status-ready {
            background: #e0f2fe;
            color: #0c4a6e;
        }
        
        .status-delivered, .status-completed {
            background: #dcfce7;
            color: #166534;
        }
        
        .status-canceled {
            background: #fee2e2;
            color: #991b1b;
        }
        
        .status-placed {
            background: #ddd6fe;
            color: #5b21b6;
        }
        
        .status-packed {
            background: #fce7f3;
            color: #9d174d;
        }
        
        .status-shipped {
            background: #ffedd5;
            color: #ea580c;
        }
    </style>
</head>
<body class="min-h-screen gradient-bg">
    <!-- Toast Notification -->
    <div id="toast" class="toast" role="alert"></div>

    <!-- Header -->
    <header class="sticky top-0 z-50 glass-card shadow-sm">
        <div class="container mx-auto px-4 py-3">
            <div class="flex items-center justify-between">
                <a href="#" onclick="showPage('home')" class="flex items-center space-x-2">
                    <span class="text-2xl">ðŸ’»</span>
                    <span class="text-xl font-bold text-primary-700">TechFix</span>
                </a>
                
                <nav class="hidden md:flex items-center space-x-8">
                    <a href="#" onclick="showPage('home')" class="text-gray-700 hover:text-primary-600 transition">Home</a>
                    <a href="#" onclick="showPage('services')" class="text-gray-700 hover:text-primary-600 transition">Services</a>
                    <a href="#" onclick="showPage('products')" class="text-gray-700 hover:text-primary-600 transition">Products</a>
                    <a href="#" class="text-gray-700 hover:text-primary-600 transition">About</a>
                    <a href="#" class="text-gray-700 hover:text-primary-600 transition">Contact</a>
                </nav>
                
                <div class="flex items-center space-x-4">
                    <div class="relative">
                        <a href="#" onclick="showPage('cart')" class="p-2 text-gray-700 hover:text-primary-600 transition">
                            <i data-lucide="shopping-cart"></i>
                            <span id="cart-count" class="cart-badge">0</span>
                        </a>
                    </div>
                    
                    <div id="auth-buttons" class="flex items-center space-x-2">
                        <button onclick="showPage('signin')" class="px-4 py-2 text-sm font-medium text-primary-700 hover:text-primary-800 transition">Sign In</button>
                        <button onclick="showPage('signup')" class="px-4 py-2 text-sm font-medium bg-primary-600 text-white rounded-lg hover:bg-primary-700 transition">Sign Up</button>
                    </div>
                    
                    <div id="user-menu" class="hidden items-center space-x-2">
                        <div class="relative group">
                            <button class="flex items-center space-x-2 text-sm font-medium text-gray-700">
                                <span id="user-name">User</span>
                                <i data-lucide="chevron-down" class="w-4 h-4"></i>
                            </button>
                            <div class="absolute right-0 mt-2 w-48 bg-white rounded-lg shadow-lg py-1 opacity-0 invisible group-hover:opacity-100 group-hover:visible transition-all duration-200 z-50">
                                <a href="#" onclick="showPage('orders')" class="block px-4 py-2 text-sm text-gray-700 hover:bg-gray-100">My Orders</a>
                                <a href="#" onclick="showPage('requests')" class="block px-4 py-2 text-sm text-gray-700 hover:bg-gray-100">Service Requests</a>
                                <a href="#" id="admin-link" class="hidden px-4 py-2 text-sm text-gray-700 hover:bg-gray-100">Admin</a>
                                <a href="#" onclick="signOut()" class="block px-4 py-2 text-sm text-gray-700 hover:bg-gray-100">Sign Out</a>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </header>

    <main class="container mx-auto px-4 py-8">
        <!-- Home Page -->
        <div id="home" class="page active">
            <!-- Hero Section -->
            <section class="mb-16">
                <div class="rounded-2xl overflow-hidden bg-gradient-to-r from-primary-500 to-secondary-500 p-8 md:p-12 text-white">
                    <div class="max-w-2xl">
                        <h1 class="text-4xl md:text-5xl font-bold mb-4">Expert Laptop Repair & Premium Accessories</h1>
                        <p class="text-lg md:text-xl mb-8">Fast, reliable, and affordable solutions for all your laptop needs. Get your device fixed or upgrade with our quality products.</p>
                        <div class="flex flex-wrap gap-4">
                            <button onclick="showPage('services')" class="px-6 py-3 bg-white text-primary-700 font-medium rounded-lg hover:bg-gray-100 transition">Our Services</button>
                            <button onclick="showPage('products')" class="px-6 py-3 bg-transparent border-2 border-white text-white font-medium rounded-lg hover:bg-white/10 transition">Shop Products</button>
                        </div>
                    </div>
                </div>
            </section>

            <!-- Highlights Section -->
            <section class="mb-16">
                <h2 class="text-3xl font-bold text-center mb-12 text-gray-800">Why Choose TechFix?</h2>
                <div class="grid grid-cols-1 md:grid-cols-3 gap-8">
                    <div class="glass-card p-6 rounded-2xl shadow-sm">
                        <div class="w-12 h-12 bg-primary-100 rounded-xl flex items-center justify-center mb-4">
                            <i data-lucide="clock" class="text-primary-600"></i>
                        </div>
                        <h3 class="text-xl font-semibold mb-2">Fast Service</h3>
                        <p class="text-gray-600">Most repairs completed within 24 hours with our express service option.</p>
                    </div>
                    <div class="glass-card p-6 rounded-2xl shadow-sm">
                        <div class="w-12 h-12 bg-primary-100 rounded-xl flex items-center justify-center mb-4">
                            <i data-lucide="shield" class="text-primary-600"></i>
                        </div>
                        <h3 class="text-xl font-semibold mb-2">Warranty Included</h3>
                        <p class="text-gray-600">All repairs and products come with a comprehensive warranty for peace of mind.</p>
                    </div>
                    <div class="glass-card p-6 rounded-2xl shadow-sm">
                        <div class="w-12 h-12 bg-primary-100 rounded-xl flex items-center justify-center mb-4">
                            <i data-lucide="award" class="text-primary-600"></i>
                        </div>
                        <h3 class="text-xl font-semibold mb-2">Expert Technicians</h3>
                        <p class="text-gray-600">Our certified technicians have years of experience with all major brands.</p>
                    </div>
                </div>
            </section>

            <!-- Featured Products Section -->
            <section class="mb-16">
                <div class="flex justify-between items-center mb-8">
                    <h2 class="text-3xl font-bold text-gray-800">Featured Products</h2>
                    <a href="#" onclick="showPage('products')" class="text-primary-600 hover:text-primary-700 font-medium flex items-center">
                        View all
                        <i data-lucide="arrow-right" class="w-4 h-4 ml-1"></i>
                    </a>
                </div>
                <div id="featured-products" class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6">
                    <!-- Products will be loaded here -->
                    <div class="skeleton h-80 rounded-2xl"></div>
                    <div class="skeleton h-80 rounded-2xl"></div>
                    <div class="skeleton h-80 rounded-2xl"></div>
                    <div class="skeleton h-80 rounded-2xl"></div>
                </div>
            </section>

            <!-- Services Preview Section -->
            <section>
                <div class="flex justify-between items-center mb-8">
                    <h2 class="text-3xl font-bold text-gray-800">Our Services</h2>
                    <a href="#" onclick="showPage('services')" class="text-primary-600 hover:text-primary-700 font-medium flex items-center">
                        View all
                        <i data-lucide="arrow-right" class="w-4 h-4 ml-1"></i>
                    </a>
                </div>
                <div id="services-preview" class="grid grid-cols-1 md:grid-cols-2 gap-6">
                    <!-- Services will be loaded here -->
                    <div class="skeleton h-40 rounded-2xl"></div>
                    <div class="skeleton h-40 rounded-2xl"></div>
                </div>
            </section>
        </div>

        <!-- Services Page -->
        <div id="services" class="page">
            <h1 class="text-3xl font-bold mb-8 text-gray-800">Our Services</h1>
            <div id="services-list" class="grid grid-cols-1 md:grid-cols-2 gap-6 mb-12">
                <!-- Services will be loaded here -->
                <div class="skeleton h-40 rounded-2xl"></div>
                <div class="skeleton h-40 rounded-2xl"></div>
                <div class="skeleton h-40 rounded-2xl"></div>
                <div class="skeleton h-40 rounded-2xl"></div>
            </div>

            <!-- Service Request Form -->
            <div class="glass-card p-6 rounded-2xl shadow-sm">
                <h2 class="text-2xl font-bold mb-6 text-gray-800">Request Service</h2>
                <form id="service-request-form" class="grid grid-cols-1 md:grid-cols-2 gap-6">
                    <div class="md:col-span-2">
                        <label for="service" class="block text-sm font-medium text-gray-700 mb-2">Select Service</label>
                        <select id="service" name="service_id" required class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-primary-500">
                            <option value="">Choose a service</option>
                            <!-- Options will be populated dynamically -->
                        </select>
                    </div>
                    <div>
                        <label for="brand" class="block text-sm font-medium text-gray-700 mb-2">Device Brand</label>
                        <input type="text" id="brand" name="brand" required class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-primary-500" placeholder="e.g., Dell, HP, Apple">
                    </div>
                    <div>
                        <label for="model" class="block text-sm font-medium text-gray-700 mb-2">Device Model</label>
                        <input type="text" id="model" name="model" required class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-primary-500" placeholder="e.g., XPS 13, MacBook Pro">
                    </div>
                    <div class="md:col-span-2">
                        <label for="issue" class="block text-sm font-medium text-gray-700 mb-2">Issue Details</label>
                        <textarea id="issue" name="issue" rows="4" required class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-primary-500" placeholder="Describe the problem you're experiencing"></textarea>
                    </div>
                    <div>
                        <label for="phone" class="block text-sm font-medium text-gray-700 mb-2">Phone Number</label>
                        <input type="tel" id="phone" name="phone" required class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-primary-500" placeholder="Your contact number">
                    </div>
                    <div>
                        <label for="date" class="block text-sm font-medium text-gray-700 mb-2">Preferred Date</label>
                        <input type="date" id="date" name="date" required class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-primary-500">
                    </div>
                    <div class="md:col-span-2">
                        <label for="address" class="block text-sm font-medium text-gray-700 mb-2">Pickup Address</label>
                        <textarea id="address" name="address" rows="3" required class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-primary-500" placeholder="Where should we pick up your device?"></textarea>
                    </div>
                    <div class="md:col-span-2">
                        <button type="submit" class="w-full px-6 py-3 bg-primary-600 text-white font-medium rounded-lg hover:bg-primary-700 transition">Submit Request</button>
                    </div>
                </form>
            </div>
        </div>

        <!-- Products Page -->
        <div id="products" class="page">
            <h1 class="text-3xl font-bold mb-8 text-gray-800">Our Products</h1>
            
            <!-- Filters and Search -->
            <div class="glass-card p-6 rounded-2xl shadow-sm mb-8">
                <div class="flex flex-col md:flex-row md:items-center gap-4">
                    <div class="flex-1">
                        <input type="text" id="search-input" placeholder="Search products..." class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-primary-500">
                    </div>
                    <div class="flex flex-wrap gap-4">
                        <select id="category-filter" class="px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-primary-500">
                            <option value="">All Categories</option>
                            <option value="accessories">Accessories</option>
                            <option value="components">Components</option>
                            <option value="peripherals">Peripherals</option>
                        </select>
                        <select id="sort-by" class="px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-primary-500">
                            <option value="newest">Newest First</option>
                            <option value="price-low">Price: Low to High</option>
                            <option value="price-high">Price: High to Low</option>
                        </select>
                    </div>
                </div>
            </div>
            
            <!-- Products Grid -->
            <div id="products-grid" class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6">
                <!-- Products will be loaded here -->
                <div class="skeleton h-80 rounded-2xl"></div>
                <div class="skeleton h-80 rounded-2xl"></div>
                <div class="skeleton h-80 rounded-2xl"></div>
                <div class="skeleton h-80 rounded-2xl"></div>
                <div class="skeleton h-80 rounded-2xl"></div>
                <div class="skeleton h-80 rounded-2xl"></div>
                <div class="skeleton h-80 rounded-2xl"></div>
                <div class="skeleton h-80 rounded-2xl"></div>
            </div>
        </div>

        <!-- Cart Page -->
        <div id="cart" class="page">
            <h1 class="text-3xl font-bold mb-8 text-gray-800">Your Cart</h1>
            
            <div id="cart-empty" class="hidden glass-card p-12 rounded-2xl shadow-sm text-center">
                <i data-lucide="shopping-cart" class="w-16 h-16 text-gray-300 mx-auto mb-4"></i>
                <h2 class="text-2xl font-semibold text-gray-600 mb-4">Your cart is empty</h2>
                <p class="text-gray-500 mb-6">Looks like you haven't added any products to your cart yet.</p>
                <button onclick="showPage('products')" class="px-6 py-3 bg-primary-600 text-white font-medium rounded-lg hover:bg-primary-700 transition">Browse Products</button>
            </div>
            
            <div id="cart-items" class="hidden grid grid-cols-1 lg:grid-cols-3 gap-8">
                <div class="lg:col-span-2">
                    <div class="glass-card p-6 rounded-2xl shadow-sm">
                        <h2 class="text-xl font-semibold mb-6 text-gray-800">Cart Items</h2>
                        <div id="cart-items-list">
                            <!-- Cart items will be loaded here -->
                        </div>
                    </div>
                </div>
                
                <div>
                    <div class="glass-card p-6 rounded-2xl shadow-sm sticky top-24">
                        <h2 class="text-xl font-semibold mb-6 text-gray-800">Order Summary</h2>
                        <div class="space-y-4 mb-6">
                            <div class="flex justify-between">
                                <span class="text-gray-600">Subtotal</span>
                                <span id="cart-subtotal" class="font-medium">â‚¹0.00</span>
                            </div>
                            <div class="flex justify-between">
                                <span class="text-gray-600">Shipping</span>
                                <span class="font-medium">â‚¹50.00</span>
                            </div>
                            <div class="flex justify-between border-t border-gray-200 pt-4">
                                <span class="text-lg font-semibold">Total</span>
                                <span id="cart-total" class="text-lg font-semibold">â‚¹0.00</span>
                            </div>
                        </div>
                        <div class="mb-6">
                            <label class="block text-sm font-medium text-gray-700 mb-2">Payment Method</label>
                            <div class="space-y-2">
                                <div class="flex items-center">
                                    <input type="radio" id="cod" name="payment" value="COD" checked class="w-4 h-4 text-primary-600 focus:ring-primary-500">
                                    <label for="cod" class="ml-2 block text-sm text-gray-700">Cash on Delivery</label>
                                </div>
                                <div class="flex items-center">
                                    <input type="radio" id="upi" name="payment" value="UPI" class="w-4 h-4 text-primary-600 focus:ring-primary-500">
                                    <label for="upi" class="ml-2 block text-sm text-gray-700">UPI Payment</label>
                                </div>
                            </div>
                        </div>
                        <button id="checkout-btn" class="w-full px-6 py-3 bg-primary-600 text-white font-medium rounded-lg hover:bg-primary-700 transition">Proceed to Checkout</button>
                    </div>
                </div>
            </div>
        </div>

        <!-- Orders Page -->
        <div id="orders" class="page">
            <h1 class="text-3xl font-bold mb-8 text-gray-800">Your Orders</h1>
            
            <div id="orders-empty" class="hidden glass-card p-12 rounded-2xl shadow-sm text-center">
                <i data-lucide="package" class="w-16 h-16 text-gray-300 mx-auto mb-4"></i>
                <h2 class="text-2xl font-semibold text-gray-600 mb-4">No orders yet</h2>
                <p class="text-gray-500 mb-6">You haven't placed any orders with us yet.</p>
                <button onclick="showPage('products')" class="px-6 py-3 bg-primary-600 text-white font-medium rounded-lg hover:bg-primary-700 transition">Browse Products</button>
            </div>
            
            <div id="orders-list" class="space-y-6">
                <!-- Orders will be loaded here -->
                <div class="skeleton h-40 rounded-2xl"></div>
                <div class="skeleton h-40 rounded-2xl"></div>
            </div>
        </div>

        <!-- Service Requests Page -->
        <div id="requests" class="page">
            <h1 class="text-3xl font-bold mb-8 text-gray-800">Service Requests</h1>
            
            <div id="requests-empty" class="hidden glass-card p-12 rounded-2xl shadow-sm text-center">
                <i data-lucide="tool" class="w-16 h-16 text-gray-300 mx-auto mb-4"></i>
                <h2 class="text-2xl font-semibold text-gray-600 mb-4">No service requests</h2>
                <p class="text-gray-500 mb-6">You haven't submitted any service requests yet.</p>
                <button onclick="showPage('services')" class="px-6 py-3 bg-primary-600 text-white font-medium rounded-lg hover:bg-primary-700 transition">View Services</button>
            </div>
            
            <div id="requests-list" class="space-y-6">
                <!-- Service requests will be loaded here -->
                <div class="skeleton h-40 rounded-2xl"></div>
                <div class="skeleton h-40 rounded-2xl"></div>
            </div>
        </div>

        <!-- Admin Dashboard -->
        <div id="admin" class="page">
            <h1 class="text-3xl font-bold mb-8 text-gray-800">Admin Dashboard</h1>
            
            <div class="glass-card p-6 rounded-2xl shadow-sm mb-8">
                <div class="flex flex-wrap gap-4 mb-6">
                    <button id="admin-products-tab" class="px-4 py-2 bg-primary-600 text-white rounded-lg font-medium">Products</button>
                    <button id="admin-services-tab" class="px-4 py-2 bg-gray-200 text-gray-700 rounded-lg font-medium">Services</button>
                    <button id="admin-orders-tab" class="px-4 py-2 bg-gray-200 text-gray-700 rounded-lg font-medium">Orders</button>
                    <button id="admin-requests-tab" class="px-4 py-2 bg-gray-200 text-gray-700 rounded-lg font-medium">Service Requests</button>
                </div>
                
                <!-- Admin Products Section -->
                <div id="admin-products" class="admin-section">
                    <div class="flex justify-between items-center mb-6">
                        <h2 class="text-xl font-semibold">Manage Products</h2>
                        <button id="add-product-btn" class="px-4 py-2 bg-primary-600 text-white rounded-lg font-medium flex items-center">
                            <i data-lucide="plus" class="w-4 h-4 mr-1"></i>
                            Add Product
                        </button>
                    </div>
                    
                    <div class="overflow-x-auto">
                        <table class="w-full">
                            <thead>
                                <tr class="border-b border-gray-200">
                                    <th class="px-4 py-2 text-left">Name</th>
                                    <th class="px-4 py-2 text-left">Category</th>
                                    <th class="px-4 py-2 text-left">Price</th>
                                    <th class="px-4 py-2 text-left">Stock</th>
                                    <th class="px-4 py-2 text-left">Status</th>
                                    <th class="px-4 py-2 text-left">Actions</th>
                                </tr>
                            </thead>
                            <tbody id="admin-products-list">
                                <!-- Products will be loaded here -->
                            </tbody>
                        </table>
                    </div>
                </div>
                
                <!-- Admin Services Section -->
                <div id="admin-services" class="admin-section hidden">
                    <div class="flex justify-between items-center mb-6">
                        <h2 class="text-xl font-semibold">Manage Services</h2>
                        <button id="add-service-btn" class="px-4 py-2 bg-primary-600 text-white rounded-lg font-medium flex items-center">
                            <i data-lucide="plus" class="w-4 h-4 mr-1"></i>
                            Add Service
                        </button>
                    </div>
                    
                    <div class="overflow-x-auto">
                        <table class="w-full">
                            <thead>
                                <tr class="border-b border-gray-200">
                                    <th class="px-4 py-2 text-left">Title</th>
                                    <th class="px-4 py-2 text-left">Price</th>
                                    <th class="px-4 py-2 text-left">ETA</th>
                                    <th class="px-4 py-2 text-left">Status</th>
                                    <th class="px-4 py-2 text-left">Actions</th>
                                </tr>
                            </thead>
                            <tbody id="admin-services-list">
                                <!-- Services will be loaded here -->
                            </tbody>
                        </table>
                    </div>
                </div>
                
                <!-- Admin Orders Section -->
                <div id="admin-orders" class="admin-section hidden">
                    <h2 class="text-xl font-semibold mb-6">Manage Orders</h2>
                    
                    <div class="overflow-x-auto">
                        <table class="w-full">
                            <thead>
                                <tr class="border-b border-gray-200">
                                    <th class="px-4 py-2 text-left">Order ID</th>
                                    <th class="px-4 py-2 text-left">Customer</th>
                                    <th class="px-4 py-2 text-left">Total</th>
                                    <th class="px-4 py-2 text-left">Status</th>
                                    <th class="px-4 py-2 text-left">Date</th>
                                    <th class="px-4 py-2 text-left">Actions</th>
                                </tr>
                            </thead>
                            <tbody id="admin-orders-list">
                                <!-- Orders will be loaded here -->
                            </tbody>
                        </table>
                    </div>
                </div>
                
                <!-- Admin Requests Section -->
                <div id="admin-requests" class="admin-section hidden">
                    <h2 class="text-xl font-semibold mb-6">Manage Service Requests</h2>
                    
                    <div class="overflow-x-auto">
                        <table class="w-full">
                            <thead>
                                <tr class="border-b border-gray-200">
                                    <th class="px-4 py-2 text-left">Request ID</th>
                                    <th class="px-4 py-2 text-left">Customer</th>
                                    <th class="px-4 py-2 text-left">Service</th>
                                    <th class="px-4 py-2 text-left">Status</th>
                                    <th class="px-4 py-2 text-left">Date</th>
                                    <th class="px-4 py-2 text-left">Actions</th>
                                </tr>
                            </thead>
                            <tbody id="admin-requests-list">
                                <!-- Service requests will be loaded here -->
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>
        </div>

        <!-- Sign In Page -->
        <div id="signin" class="page">
            <div class="max-w-md mx-auto glass-card p-8 rounded-2xl shadow-sm">
                <h1 class="text-3xl font-bold mb-2 text-gray-800">Sign In</h1>
                <p class="text-gray-600 mb-8">Welcome back! Please sign in to your account.</p>
                
                <form id="signin-form" class="space-y-6">
                    <div>
                        <label for="signin-email" class="block text-sm font-medium text-gray-700 mb-2">Email Address</label>
                        <input type="email" id="signin-email" required class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-primary-500" placeholder="your.email@example.com">
                    </div>
                    <div>
                        <label for="signin-password" class="block text-sm font-medium text-gray-700 mb-2">Password</label>
                        <input type="password" id="signin-password" required class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-primary-500" placeholder="Your password">
                    </div>
                    <button type="submit" class="w-full px-6 py-3 bg-primary-600 text-white font-medium rounded-lg hover:bg-primary-700 transition">Sign In</button>
                </form>
                
                <p class="text-center mt-6 text-gray-600">
                    Don't have an account? 
                    <a href="#" onclick="showPage('signup')" class="text-primary-600 hover:text-primary-700 font-medium">Sign up here</a>
                </p>
            </div>
        </div>

        <!-- Sign Up Page -->
        <div id="signup" class="page">
            <div class="max-w-md mx-auto glass-card p-8 rounded-2xl shadow-sm">
                <h1 class="text-3xl font-bold mb-2 text-gray-800">Create Account</h1>
                <p class="text-gray-600 mb-8">Join us today! Create your account to get started.</p>
                
                <form id="signup-form" class="space-y-6">
                    <div>
                        <label for="signup-name" class="block text-sm font-medium text-gray-700 mb-2">Full Name</label>
                        <input type="text" id="signup-name" required class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-primary-500" placeholder="John Doe">
                    </div>
                    <div>
                        <label for="signup-email" class="block text-sm font-medium text-gray-700 mb-2">Email Address</label>
                        <input type="email" id="signup-email" required class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-primary-500" placeholder="your.email@example.com">
                    </div>
                    <div>
                        <label for="signup-phone" class="block text-sm font-medium text-gray-700 mb-2">Phone Number</label>
                        <input type="tel" id="signup-phone" required class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-primary-500" placeholder="+91 1234567890">
                    </div>
                    <div>
                        <label for="signup-password" class="block text-sm font-medium text-gray-700 mb-2">Password</label>
                        <input type="password" id="signup-password" required class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-primary-500" placeholder="Create a password">
                    </div>
                    <div>
                        <label for="signup-confirm" class="block text-sm font-medium text-gray-700 mb-2">Confirm Password</label>
                        <input type="password" id="signup-confirm" required class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-primary-500" placeholder="Confirm your password">
                    </div>
                    <button type="submit" class="w-full px-6 py-3 bg-primary-600 text-white font-medium rounded-lg hover:bg-primary-700 transition">Create Account</button>
                </form>
                
                <p class="text-center mt-6 text-gray-600">
                    Already have an account? 
                    <a href="#" onclick="showPage('signin')" class="text-primary-600 hover:text-primary-700 font-medium">Sign in here</a>
                </p>
            </div>
        </div>
    </main>

    <!-- Footer -->
    <footer class="bg-white mt-16">
        <div class="container mx-auto px-4 py-12">
            <div class="grid grid-cols-1 md:grid-cols-4 gap-8">
                <div>
                    <a href="#" class="flex items-center space-x-2 mb-4">
                        <span class="text-2xl">ðŸ’»</span>
                        <span class="text-xl font-bold text-primary-700">TechFix</span>
                    </a>
                    <p class="text-gray-600 mb-4">Professional laptop repair services and high-quality accessories.</p>
                    <div class="flex space-x-4">
                        <a href="#" class="text-gray-400 hover:text-primary-600 transition">
                            <i data-lucide="facebook"></i>
                        </a>
                        <a href="#" class="text-gray-400 hover:text-primary-600 transition">
                            <i data-lucide="twitter"></i>
                        </a>
                        <a href="#" class="text-gray-400 hover:text-primary-600 transition">
                            <i data-lucide="instagram"></i>
                        </a>
                        <a href="#" class="text-gray-400 hover:text-primary-600 transition">
                            <i data-lucide="linkedin"></i>
                        </a>
                    </div>
                </div>
                <div>
                    <h3 class="text-lg font-semibold mb-4">Quick Links</h3>
                    <ul class="space-y-2">
                        <li><a href="#" onclick="showPage('home')" class="text-gray-600 hover:text-primary-600 transition">Home</a></li>
                        <li><a href="#" onclick="showPage('services')" class="text-gray-600 hover:text-primary-600 transition">Services</a></li>
                        <li><a href="#" onclick="showPage('products')" class="text-gray-600 hover:text-primary-600 transition">Products</a></li>
                        <li><a href="#" class="text-gray-600 hover:text-primary-600 transition">About Us</a></li>
                        <li><a href="#" class="text-gray-600 hover:text-primary-600 transition">Contact</a></li>
                    </ul>
                </div>
                <div>
                    <h3 class="text-lg font-semibold mb-4">Services</h3>
                    <ul class="space-y-2">
                        <li><a href="#" class="text-gray-600 hover:text-primary-600 transition">Screen Replacement</a></li>
                        <li><a href="#" class="text-gray-600 hover:text-primary-600 transition">Battery Replacement</a></li>
                        <li><a href="#" class="text-gray-600 hover:text-primary-600 transition">Data Recovery</a></li>
                        <li><a href="#" class="text-gray-600 hover:text-primary-600 transition">Virus Removal</a></li>
                        <li><a href="#" class="text-gray-600 hover:text-primary-600 transition">Hardware Upgrade</a></li>
                    </ul>
                </div>
                <div>
                    <h3 class="text-lg font-semibold mb-4">Contact Us</h3>
                    <ul class="space-y-2">
                        <li class="flex items-start space-x-2">
                            <i data-lucide="map-pin" class="w-5 h-5 text-primary-600 mt-0.5"></i>
                            <span class="text-gray-600">123 Tech Street, Bangalore, India</span>
                        </li>
                        <li class="flex items-start space-x-2">
                            <i data-lucide="phone" class="w-5 h-5 text-primary-600 mt-0.5"></i>
                            <span class="text-gray-600">+91 9876543210</span>
                        </li>
                        <li class="flex items-start space-x-2">
                            <i data-lucide="mail" class="w-5 h-5 text-primary-600 mt-0.5"></i>
                            <span class="text-gray-600">info@techfix.com</span>
                        </li>
                        <li class="flex items-start space-x-2">
                            <i data-lucide="clock" class="w-5 h-5 text-primary-600 mt-0.5"></i>
                            <span class="text-gray-600">Mon-Sat: 9AM - 6PM</span>
                        </li>
                    </ul>
                </div>
            </div>
            <div class="border-t border-gray-200 mt-8 pt-8 text-center text-gray-500">
                <p>Â© 2023 TechFix. All rights reserved.</p>
            </div>
        </div>
    </footer>

    <!-- Supabase Initialization -->
    <script>
        // Initialize Supabase
        window.__env = {
            SUPABASE_URL: "https://xxirbkuqbvobeeaoawav.supabase.co",
            SUPABASE_ANON_KEY: "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Inh4aXJia3VxYnZvYmVlYW9hd2F2Iiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTU4NzcxNjAsImV4cCI6MjA3MTQ1MzE2MH0.DRYHdO6H4uX-CNcwVxBA-temECoRRO7KQldQrKavdd4"
        };

        const supabase = window.supabase.createClient(
            window.__env.SUPABASE_URL,
            window.__env.SUPABASE_ANON_KEY
        );

        // Global state
        let currentUser = null;
        let cart = [];
        let products = [];
        let services = [];

        // DOM Ready
        document.addEventListener('DOMContentLoaded', function() {
            // Initialize Lucide icons
            lucide.createIcons();
            
            // Check for active session
            checkAuth();
            
            // Load initial data
            loadProducts();
            loadServices();
            
            // Set up event listeners
            setupEventListeners();
        });

        // Auth Functions
        async function checkAuth() {
            const { data: { session } } = await supabase.auth.getSession();
            if (session) {
                const { data: profile } = await supabase
                    .from('profiles')
                    .select('*')
                    .eq('id', session.user.id)
                    .single();
                
                if (profile) {
                    currentUser = { ...session.user, ...profile };
                    updateUIForAuth();
                    
                    // Load user-specific data
                    loadCart();
                    loadOrders();
                    loadServiceRequests();
                }
            } else {
                updateUIForUnauth();
            }
            
            // Listen for auth changes
            supabase.auth.onAuthStateChange(async (event, session) => {
                if (event === 'SIGNED_IN' && session) {
                    const { data: profile } = await supabase
                        .from('profiles')
                        .select('*')
                        .eq('id', session.user.id)
                        .single();
                    
                    if (profile) {
                        currentUser = { ...session.user, ...profile };
                        updateUIForAuth();
                        
                        // Load user-specific data
                        loadCart();
                        loadOrders();
                        loadServiceRequests();
                    }
                } else if (event === 'SIGNED_OUT') {
                    currentUser = null;
                    updateUIForUnauth();
                    cart = [];
                    updateCartUI();
                }
            });
        }

        function updateUIForAuth() {
            document.getElementById('auth-buttons').classList.add('hidden');
            document.getElementById('user-menu').classList.remove('hidden');
            document.getElementById('user-name').textContent = currentUser.full_name || currentUser.email;
            
            // Show admin link if user is admin
            if (currentUser.role === 'admin') {
                document.getElementById('admin-link').classList.remove('hidden');
            }
        }

        function updateUIForUnauth() {
            document.getElementById('auth-buttons').classList.remove('hidden');
            document.getElementById('user-menu').classList.add('hidden');
            document.getElementById('admin-link').classList.add('hidden');
        }

        async function signUp(email, password, fullName, phone) {
            const { data, error } = await supabase.auth.signUp({
                email,
                password
            });
            
            if (error) {
                showToast(error.message, 'error');
                return;
            }
            
            if (data.user) {
                // Create profile
                const { error: profileError } = await supabase
                    .from('profiles')
                    .insert([
                        { 
                            id: data.user.id, 
                            full_name: fullName,
                            phone: phone
                        }
                    ]);
                
                if (profileError) {
                    showToast(profileError.message, 'error');
                    return;
                }
                
                showToast('Account created successfully! Please check your email for verification.', 'success');
                showPage('signin');
            }
        }

        async function signIn(email, password) {
            const { data, error } = await supabase.auth.signInWithPassword({
                email,
                password
            });
            
            if (error) {
                showToast(error.message, 'error');
                return;
            }
            
            showToast('Signed in successfully!', 'success');
            showPage('home');
        }

        async function signOut() {
            const { error } = await supabase.auth.signOut();
            if (error) {
                showToast(error.message, 'error');
                return;
            }
            
            showToast('Signed out successfully', 'success');
            showPage('home');
        }

        // Page Navigation
        function showPage(pageId) {
            // Hide all pages
            document.querySelectorAll('.page').forEach(page => {
                page.classList.remove('active');
            });
            
            // Show requested page
            document.getElementById(pageId).classList.add('active');
            
            // Scroll to top
            window.scrollTo(0, 0);
            
            // Load page-specific data
            if (pageId === 'products') {
                loadProducts();
            } else if (pageId === 'services') {
                loadServices();
            } else if (pageId === 'cart') {
                loadCart();
            } else if (pageId === 'orders') {
                loadOrders();
            } else if (pageId === 'requests') {
                loadServiceRequests();
            } else if (pageId === 'admin') {
                if (currentUser && currentUser.role === 'admin') {
                    loadAdminData();
                } else {
                    showToast('Access denied. Admin only.', 'error');
                    showPage('home');
                }
            }
        }

        // Data Loading Functions
        async function loadProducts() {
            const { data, error } = await supabase
                .from('products')
                .select('*')
                .eq('is_active', true)
                .order('created_at', { ascending: false });
            
            if (error) {
                showToast('Error loading products', 'error');
                console.error(error);
                return;
            }
            
            products = data;
            renderProducts();
            
            // Also update featured products on home page
            renderFeaturedProducts();
        }

        async function loadServices() {
            const { data, error } = await supabase
                .from('services')
                .select('*')
                .eq('is_active', true)
                .order('created_at', { ascending: false });
            
            if (error) {
                showToast('Error loading services', 'error');
                console.error(error);
                return;
            }
            
            services = data;
            renderServices();
            
            // Also update services preview on home page
            renderServicesPreview();
            
            // Populate service dropdown in request form
            const serviceSelect = document.getElementById('service');
            serviceSelect.innerHTML = '<option value="">Choose a service</option>';
            
            services.forEach(service => {
                const option = document.createElement('option');
                option.value = service.id;
                option.textContent = `${service.title} - â‚¹${service.base_price}`;
                serviceSelect.appendChild(option);
            });
        }

        async function loadCart() {
            if (!currentUser) {
                // For non-logged in users, use local storage
                const localCart = localStorage.getItem('cart');
                cart = localCart ? JSON.parse(localCart) : [];
                updateCartUI();
                return;
            }
            
            const { data, error } = await supabase
                .from('cart_items')
                .select(`
                    *,
                    products (*)
                `)
                .eq('user_id', currentUser.id);
            
            if (error) {
                showToast('Error loading cart', 'error');
                console.error(error);
                return;
            }
            
            cart = data.map(item => ({
                id: item.product_id,
                qty: item.qty,
                ...item.products
            }));
            
            updateCartUI();
        }

        async function loadOrders() {
            if (!currentUser) return;
            
            const { data, error } = await supabase
                .from('orders')
                .select(`
                    *,
                    order_items (
                        *,
                        products (*)
                    )
                `)
                .eq('user_id', currentUser.id)
                .order('created_at', { ascending: false });
            
            if (error) {
                showToast('Error loading orders', 'error');
                console.error(error);
                return;
            }
            
            renderOrders(data);
        }

        async function loadServiceRequests() {
            if (!currentUser) return;
            
            const { data, error } = await supabase
                .from('service_requests')
                .select(`
                    *,
                    services (*)
                `)
                .eq('user_id', currentUser.id)
                .order('created_at', { ascending: false });
            
            if (error) {
                showToast('Error loading service requests', 'error');
                console.error(error);
                return;
            }
            
            renderServiceRequests(data);
        }

        async function loadAdminData() {
            if (!currentUser || currentUser.role !== 'admin') return;
            
            // Load admin products
            const { data: products, error: productsError } = await supabase
                .from('products')
                .select('*')
                .order('created_at', { ascending: false });
            
            if (productsError) {
                showToast('Error loading admin products', 'error');
                console.error(productsError);
            } else {
                renderAdminProducts(products);
            }
            
            // Load admin services
            const { data: services, error: servicesError } = await supabase
                .from('services')
                .select('*')
                .order('created_at', { ascending: false });
            
            if (servicesError) {
                showToast('Error loading admin services', 'error');
                console.error(servicesError);
            } else {
                renderAdminServices(services);
            }
            
            // Load admin orders
            const { data: orders, error: ordersError } = await supabase
                .from('orders')
                .select(`
                    *,
                    profiles (full_name, phone),
                    order_items (
                        *,
                        products (*)
                    )
                `)
                .order('created_at', { ascending: false });
            
            if (ordersError) {
                showToast('Error loading admin orders', 'error');
                console.error(ordersError);
            } else {
                renderAdminOrders(orders);
            }
            
            // Load admin service requests
            const { data: requests, error: requestsError } = await supabase
                .from('service_requests')
                .select(`
                    *,
                    services (*),
                    profiles (full_name, phone)
                `)
                .order('created_at', { ascending: false });
            
            if (requestsError) {
                showToast('Error loading admin service requests', 'error');
                console.error(requestsError);
            } else {
                renderAdminServiceRequests(requests);
            }
        }

        // Rendering Functions
        function renderProducts() {
            const container = document.getElementById('products-grid');
            if (!container) return;
            
            if (products.length === 0) {
                container.innerHTML = `
                    <div class="md:col-span-4 py-12 text-center">
                        <i data-lucide="package" class="w-16 h-16 text-gray-300 mx-auto mb-4"></i>
                        <h3 class="text-lg font-medium text-gray-500">No products found</h3>
                    </div>
                `;
                lucide.createIcons();
                return;
            }
            
            container.innerHTML = products.map(product => `
                <div class="bg-white rounded-2xl overflow-hidden shadow-sm hover:shadow-md transition">
                    <div class="h-48 bg-gray-200 overflow-hidden">
                        <img src="${product.thumbnail_url || 'https://via.placeholder.com/300'}" alt="${product.name}" class="w-full h-full object-cover">
                    </div>
                    <div class="p-4">
                        <div class="flex justify-between items-start mb-2">
                            <h3 class="font-semibold text-gray-800">${product.name}</h3>
                            ${product.stock > 0 ? 
                                `<span class="text-xs bg-green-100 text-green-800 px-2 py-1 rounded-full">In Stock</span>` : 
                                `<span class="text-xs bg-red-100 text-red-800 px-2 py-1 rounded-full">Out of Stock</span>`
                            }
                        </div>
                        <p class="text-sm text-gray-600 mb-4">${product.brand} â€¢ ${product.category}</p>
                        <div class="flex items-center justify-between">
                            <div>
                                <span class="text-lg font-bold text-gray-800">â‚¹${product.price}</span>
                                ${product.mrp && product.mrp > product.price ? 
                                    `<span class="text-sm text-gray-500 line-through ml-2">â‚¹${product.mrp}</span>` : ''
                                }
                            </div>
                            <button onclick="addToCart(${product.id})" ${product.stock === 0 ? 'disabled' : ''} 
                                class="p-2 bg-primary-100 text-primary-700 rounded-lg hover:bg-primary-200 transition ${product.stock === 0 ? 'opacity-50 cursor-not-allowed' : ''}">
                                <i data-lucide="shopping-cart" class="w-5 h-5"></i>
                            </button>
                        </div>
                    </div>
                </div>
            `).join('');
            
            lucide.createIcons();
        }

        function renderFeaturedProducts() {
            const container = document.getElementById('featured-products');
            if (!container) return;
            
            if (products.length === 0) return;
            
            // Get first 4 products
            const featured = products.slice(0, 4);
            
            container.innerHTML = featured.map(product => `
                <div class="bg-white rounded-2xl overflow-hidden shadow-sm hover:shadow-md transition">
                    <div class="h-48 bg-gray-200 overflow-hidden">
                        <img src="${product.thumbnail_url || 'https://via.placeholder.com/300'}" alt="${product.name}" class="w-full h-full object-cover">
                    </div>
                    <div class="p-4">
                        <div class="flex justify-between items-start mb-2">
                            <h3 class="font-semibold text-gray-800">${product.name}</h3>
                            ${product.stock > 0 ? 
                                `<span class="text-xs bg-green-100 text-green-800 px-2 py-1 rounded-full">In Stock</span>` : 
                                `<span class="text-xs bg-red-100 text-red-800 px-2 py-1 rounded-full">Out of Stock</span>`
                            }
                        </div>
                        <p class="text-sm text-gray-600 mb-4">${product.brand}</p>
                        <div class="flex items-center justify-between">
                            <div>
                                <span class="text-lg font-bold text-gray-800">â‚¹${product.price}</span>
                                ${product.mrp && product.mrp > product.price ? 
                                    `<span class="text-sm text-gray-500 line-through ml-2">â‚¹${product.mrp}</span>` : ''
                                }
                            </div>
                            <button onclick="addToCart(${product.id})" ${product.stock === 0 ? 'disabled' : ''} 
                                class="p-2 bg-primary-100 text-primary-700 rounded-lg hover:bg-primary-200 transition ${product.stock === 0 ? 'opacity-50 cursor-not-allowed' : ''}">
                                <i data-lucide="shopping-cart" class="w-5 h-5"></i>
                            </button>
                        </div>
                    </div>
                </div>
            `).join('');
            
            lucide.createIcons();
        }

        function renderServices() {
            const container = document.getElementById('services-list');
            if (!container) return;
            
            if (services.length === 0) {
                container.innerHTML = `
                    <div class="md:col-span-2 py-12 text-center">
                        <i data-lucide="settings" class="w-16 h-16 text-gray-300 mx-auto mb-4"></i>
                        <h3 class="text-lg font-medium text-gray-500">No services found</h3>
                    </div>
                `;
                lucide.createIcons();
                return;
            }
            
            container.innerHTML = services.map(service => `
                <div class="glass-card p-6 rounded-2xl shadow-sm">
                    <h3 class="text-xl font-semibold mb-2">${service.title}</h3>
                    <p class="text-gray-600 mb-4">${service.description}</p>
                    <div class="flex justify-between items-center">
                        <div>
                            <span class="text-2xl font-bold text-primary-600">â‚¹${service.base_price}</span>
                            <span class="text-gray-500 block">ETA: ${service.eta_days} days</span>
                        </div>
                        <button onclick="document.getElementById('service').value = '${service.id}'; document.getElementById('service-request-form').scrollIntoView({ behavior: 'smooth' })" 
                            class="px-4 py-2 bg-primary-600 text-white rounded-lg hover:bg-primary-700 transition">
                            Request Service
                        </button>
                    </div>
                </div>
            `).join('');
        }

        function renderServicesPreview() {
            const container = document.getElementById('services-preview');
            if (!container) return;
            
            if (services.length === 0) return;
            
            // Get first 2 services
            const preview = services.slice(0, 2);
            
            container.innerHTML = preview.map(service => `
                <div class="glass-card p-6 rounded-2xl shadow-sm">
                    <h3 class="text-xl font-semibold mb-2">${service.title}</h3>
                    <p class="text-gray-600 mb-4 line-clamp-2">${service.description}</p>
                    <div class="flex justify-between items-center">
                        <div>
                            <span class="text-2xl font-bold text-primary-600">â‚¹${service.base_price}</span>
                        </div>
                        <button onclick="showPage('services')" class="px-4 py-2 bg-primary-600 text-white rounded-lg hover:bg-primary-700 transition">
                            View Details
                        </button>
                    </div>
                </div>
            `).join('');
        }

        function updateCartUI() {
            const cartCount = document.getElementById('cart-count');
            const cartItems = document.getElementById('cart-items');
            const cartEmpty = document.getElementById('cart-empty');
            const cartItemsList = document.getElementById('cart-items-list');
            const cartSubtotal = document.getElementById('cart-subtotal');
            const cartTotal = document.getElementById('cart-total');
            
            // Update cart count
            cartCount.textContent = cart.reduce((total, item) => total + item.qty, 0);
            
            // Show empty state or cart items
            if (cart.length === 0) {
                cartItems.classList.add('hidden');
                cartEmpty.classList.remove('hidden');
                return;
            }
            
            cartEmpty.classList.add('hidden');
            cartItems.classList.remove('hidden');
            
            // Calculate totals
            const subtotal = cart.reduce((total, item) => total + (item.price * item.qty), 0);
            const total = subtotal + 50; // Adding shipping
            
            cartSubtotal.textContent = `â‚¹${subtotal.toFixed(2)}`;
            cartTotal.textContent = `â‚¹${total.toFixed(2)}`;
            
            // Render cart items
            cartItemsList.innerHTML = cart.map(item => `
                <div class="flex items-center py-4 border-b border-gray-200">
                    <div class="h-16 w-16 flex-shrink-0 overflow-hidden rounded-lg">
                        <img src="${item.thumbnail_url || 'https://via.placeholder.com/100'}" alt="${item.name}" class="h-full w-full object-cover">
                    </div>
                    <div class="ml-4 flex-1">
                        <h3 class="text-gray-800 font-medium">${item.name}</h3>
                        <p class="text-gray-600">â‚¹${item.price} x ${item.qty}</p>
                    </div>
                    <div class="flex items-center space-x-2">
                        <button onclick="updateCartQty(${item.id}, ${item.qty - 1})" class="p-1 text-gray-500 hover:text-primary-600">
                            <i data-lucide="minus" class="w-4 h-4"></i>
                        </button>
                        <span class="w-8 text-center">${item.qty}</span>
                        <button onclick="updateCartQty(${item.id}, ${item.qty + 1})" class="p-1 text-gray-500 hover:text-primary-600">
                            <i data-lucide="plus" class="w-4 h-4"></i>
                        </button>
                        <button onclick="removeFromCart(${item.id})" class="p-1 text-gray-500 hover:text-red-600 ml-2">
                            <i data-lucide="trash-2" class="w-4 h-4"></i>
                        </button>
                    </div>
                </div>
            `).join('');
            
            lucide.createIcons();
        }

        function renderOrders(orders) {
            const container = document.getElementById('orders-list');
            const emptyState = document.getElementById('orders-empty');
            
            if (!orders || orders.length === 0) {
                if (container) container.innerHTML = '';
                if (emptyState) emptyState.classList.remove('hidden');
                return;
            }
            
            if (emptyState) emptyState.classList.add('hidden');
            if (!container) return;
            
            container.innerHTML = orders.map(order => `
                <div class="glass-card p-6 rounded-2xl shadow-sm">
                    <div class="flex justify-between items-start mb-4">
                        <div>
                            <h3 class="font-semibold text-gray-800">Order #${order.id}</h3>
                            <p class="text-sm text-gray-600">Placed on ${new Date(order.created_at).toLocaleDateString()}</p>
                        </div>
                        <span class="status-badge status-${order.status}">${order.status}</span>
                    </div>
                    
                    <div class="mb-4">
                        ${order.order_items.map(item => `
                            <div class="flex items-center py-2">
                                <div class="h-12 w-12 flex-shrink-0 overflow-hidden rounded-lg">
                                    <img src="${item.products.thumbnail_url || 'https://via.placeholder.com/100'}" alt="${item.products.name}" class="h-full w-full object-cover">
                                </div>
                                <div class="ml-4">
                                    <h4 class="text-gray-800">${item.products.name}</h4>
                                    <p class="text-gray-600">â‚¹${item.price} x ${item.qty}</p>
                                </div>
                            </div>
                        `).join('')}
                    </div>
                    
                    <div class="flex justify-between items-center border-t border-gray-200 pt-4">
                        <p class="text-gray-600">Payment: ${order.payment_method}</p>
                        <p class="text-lg font-semibold text-gray-800">Total: â‚¹${order.total}</p>
                    </div>
                </div>
            `).join('');
            
            lucide.createIcons();
        }

        function renderServiceRequests(requests) {
            const container = document.getElementById('requests-list');
            const emptyState = document.getElementById('requests-empty');
            
            if (!requests || requests.length === 0) {
                if (container) container.innerHTML = '';
                if (emptyState) emptyState.classList.remove('hidden');
                return;
            }
            
            if (emptyState) emptyState.classList.add('hidden');
            if (!container) return;
            
            container.innerHTML = requests.map(request => `
                <div class="glass-card p-6 rounded-2xl shadow-sm">
                    <div class="flex justify-between items-start mb-4">
                        <div>
                            <h3 class="font-semibold text-gray-800">${request.services.title}</h3>
                            <p class="text-sm text-gray-600">Requested on ${new Date(request.created_at).toLocaleDateString()}</p>
                        </div>
                        <span class="status-badge status-${request.status}">${request.status.replace('_', ' ')}</span>
                    </div>
                    
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-4 mb-4">
                        <div>
                            <p class="text-sm text-gray-600">Device</p>
                            <p class="text-gray-800">${request.device_brand} ${request.device_model}</p>
                        </div>
                        <div>
                            <p class="text-sm text-gray-600">Preferred Date</p>
                            <p class="text-gray-800">${new Date(request.preferred_date).toLocaleDateString()}</p>
                        </div>
                        <div>
                            <p class="text-sm text-gray-600">Phone</p>
                            <p class="text-gray-800">${request.phone}</p>
                        </div>
                        <div>
                            <p class="text-sm text-gray-600">Estimated Price</p>
                            <p class="text-gray-800">â‚¹${request.services.base_price}</p>
                        </div>
                    </div>
                    
                    <div class="mb-4">
                        <p class="text-sm text-gray-600">Issue Details</p>
                        <p class="text-gray-800">${request.issue_details}</p>
                    </div>
                    
                    <div>
                        <p class="text-sm text-gray-600">Pickup Address</p>
                        <p class="text-gray-800">${request.pickup_address}</p>
                    </div>
                </div>
            `).join('');
        }

        function renderAdminProducts(products) {
            const container = document.getElementById('admin-products-list');
            if (!container) return;
            
            container.innerHTML = products.map(product => `
                <tr class="border-b border-gray-200">
                    <td class="px-4 py-3">${product.name}</td>
                    <td class="px-4 py-3">${product.category}</td>
                    <td class="px-4 py-3">â‚¹${product.price}</td>
                    <td class="px-4 py-3">${product.stock}</td>
                    <td class="px-4 py-3">
                        <span class="text-xs px-2 py-1 rounded-full ${product.is_active ? 'bg-green-100 text-green-800' : 'bg-red-100 text-red-800'}">
                            ${product.is_active ? 'Active' : 'Inactive'}
                        </span>
                    </td>
                    <td class="px-4 py-3">
                        <button onclick="editProduct(${product.id})" class="p-1 text-blue-600 hover:text-blue-800">
                            <i data-lucide="edit" class="w-4 h-4"></i>
                        </button>
                        <button onclick="deleteProduct(${product.id})" class="p-1 text-red-600 hover:text-red-800 ml-2">
                            <i data-lucide="trash-2" class="w-4 h-4"></i>
                        </button>
                    </td>
                </tr>
            `).join('');
            
            lucide.createIcons();
        }

        function renderAdminServices(services) {
            const container = document.getElementById('admin-services-list');
            if (!container) return;
            
            container.innerHTML = services.map(service => `
                <tr class="border-b border-gray-200">
                    <td class="px-4 py-3">${service.title}</td>
                    <td class="px-4 py-3">â‚¹${service.base_price}</td>
                    <td class="px-4 py-3">${service.eta_days} days</td>
                    <td class="px-4 py-3">
                        <span class="text-xs px-2 py-1 rounded-full ${service.is_active ? 'bg-green-100 text-green-800' : 'bg-red-100 text-red-800'}">
                            ${service.is_active ? 'Active' : 'Inactive'}
                        </span>
                    </td>
                    <td class="px-4 py-3">
                        <button onclick="editService(${service.id})" class="p-1 text-blue-600 hover:text-blue-800">
                            <i data-lucide="edit" class="w-4 h-4"></i>
                        </button>
                        <button onclick="deleteService(${service.id})" class="p-1 text-red-600 hover:text-red-800 ml-2">
                            <i data-lucide="trash-2" class="w-4 h-4"></i>
                        </button>
                    </td>
                </tr>
            `).join('');
            
            lucide.createIcons();
        }

        function renderAdminOrders(orders) {
            const container = document.getElementById('admin-orders-list');
            if (!container) return;
            
            container.innerHTML = orders.map(order => `
                <tr class="border-b border-gray-200">
                    <td class="px-4 py-3">#${order.id}</td>
                    <td class="px-4 py-3">${order.profiles.full_name}<br><span class="text-sm text-gray-600">${order.profiles.phone}</span></td>
                    <td class="px-4 py-3">â‚¹${order.total}</td>
                    <td class="px-4 py-3">
                        <span class="status-badge status-${order.status}">${order.status}</span>
                    </td>
                    <td class="px-4 py-3">${new Date(order.created_at).toLocaleDateString()}</td>
                    <td class="px-4 py-3">
                        <select onchange="updateOrderStatus(${order.id}, this.value)" class="text-sm border border-gray-300 rounded px-2 py-1">
                            <option value="placed" ${order.status === 'placed' ? 'selected' : ''}>Placed</option>
                            <option value="packed" ${order.status === 'packed' ? 'selected' : ''}>Packed</option>
                            <option value="shipped" ${order.status === 'shipped' ? 'selected' : ''}>Shipped</option>
                            <option value="delivered" ${order.status === 'delivered' ? 'selected' : ''}>Delivered</option>
                            <option value="canceled" ${order.status === 'canceled' ? 'selected' : ''}>Canceled</option>
                        </select>
                    </td>
                </tr>
            `).join('');
        }

        function renderAdminServiceRequests(requests) {
            const container = document.getElementById('admin-requests-list');
            if (!container) return;
            
            container.innerHTML = requests.map(request => `
                <tr class="border-b border-gray-200">
                    <td class="px-4 py-3">#${request.id}</td>
                    <td class="px-4 py-3">${request.profiles.full_name}<br><span class="text-sm text-gray-600">${request.profiles.phone}</span></td>
                    <td class="px-4 py-3">${request.services.title}</td>
                    <td class="px-4 py-3">
                        <span class="status-badge status-${request.status}">${request.status.replace('_', ' ')}</span>
                    </td>
                    <td class="px-4 py-3">${new Date(request.created_at).toLocaleDateString()}</td>
                    <td class="px-4 py-3">
                        <select onchange="updateServiceRequestStatus(${request.id}, this.value)" class="text-sm border border-gray-300 rounded px-2 py-1">
                            <option value="new" ${request.status === 'new' ? 'selected' : ''}>New</option>
                            <option value="accepted" ${request.status === 'accepted' ? 'selected' : ''}>Accepted</option>
                            <option value="in_progress" ${request.status === 'in_progress' ? 'selected' : ''}>In Progress</option>
                            <option value="ready" ${request.status === 'ready' ? 'selected' : ''}>Ready</option>
                            <option value="delivered" ${request.status === 'delivered' ? 'selected' : ''}>Delivered</option>
                            <option value="canceled" ${request.status === 'canceled' ? 'selected' : ''}>Canceled</option>
                        </select>
                    </td>
                </tr>
            `).join('');
        }

        // Cart Functions
        async function addToCart(productId) {
            if (!currentUser) {
                // For non-logged in users, use local storage
                const product = products.find(p => p.id === productId);
                if (!product) return;
                
                const existingItem = cart.find(item => item.id === productId);
                
                if (existingItem) {
                    existingItem.qty += 1;
                } else {
                    cart.push({ ...product, qty: 1 });
                }
                
                localStorage.setItem('cart', JSON.stringify(cart));
                updateCartUI();
                showToast('Added to cart', 'success');
                return;
            }
            
            const { error } = await supabase
                .from('cart_items')
                .upsert([
                    { 
                        user_id: currentUser.id, 
                        product_id: productId, 
                        qty: 1 
                    }
                ], { 
                    onConflict: 'user_id,product_id',
                    ignoreDuplicates: false
                })
                .select();
            
            if (error) {
                showToast('Error adding to cart', 'error');
                console.error(error);
                return;
            }
            
            // Reload cart
            loadCart();
            showToast('Added to cart', 'success');
        }

        async function updateCartQty(productId, newQty) {
            if (newQty < 1) {
                removeFromCart(productId);
                return;
            }
            
            if (!currentUser) {
                // For non-logged in users, use local storage
                const item = cart.find(item => item.id === productId);
                if (item) {
                    item.qty = newQty;
                    localStorage.setItem('cart', JSON.stringify(cart));
                    updateCartUI();
                }
                return;
            }
            
            const { error } = await supabase
                .from('cart_items')
                .update({ qty: newQty })
                .eq('user_id', currentUser.id)
                .eq('product_id', productId);
            
            if (error) {
                showToast('Error updating cart', 'error');
                console.error(error);
                return;
            }
            
            // Reload cart
            loadCart();
        }

        async function removeFromCart(productId) {
            if (!currentUser) {
                // For non-logged in users, use local storage
                cart = cart.filter(item => item.id !== productId);
                localStorage.setItem('cart', JSON.stringify(cart));
                updateCartUI();
                showToast('Removed from cart', 'success');
                return;
            }
            
            const { error } = await supabase
                .from('cart_items')
                .delete()
                .eq('user_id', currentUser.id)
                .eq('product_id', productId);
            
            if (error) {
                showToast('Error removing from cart', 'error');
                console.error(error);
                return;
            }
            
            // Reload cart
            loadCart();
            showToast('Removed from cart', 'success');
        }

        async function checkout() {
            if (!currentUser) {
                showToast('Please sign in to checkout', 'error');
                showPage('signin');
                return;
            }
            
            if (cart.length === 0) {
                showToast('Your cart is empty', 'error');
                return;
            }
            
            const paymentMethod = document.querySelector('input[name="payment"]:checked').value;
            const total = cart.reduce((sum, item) => sum + (item.price * item.qty), 0) + 50;
            
            // Create order
            const { data: order, error: orderError } = await supabase
                .from('orders')
                .insert({
                    user_id: currentUser.id,
                    payment_method: paymentMethod,
                    total: total
                })
                .select()
                .single();
            
            if (orderError) {
                showToast('Error creating order', 'error');
                console.error(orderError);
                return;
            }
            
            // Create order items
            const orderItems = cart.map(item => ({
                order_id: order.id,
                product_id: item.id,
                qty: item.qty,
                price: item.price
            }));
            
            const { error: itemsError } = await supabase
                .from('order_items')
                .insert(orderItems);
            
            if (itemsError) {
                showToast('Error creating order items', 'error');
                console.error(itemsError);
                return;
            }
            
            // Clear cart
            const { error: cartError } = await supabase
                .from('cart_items')
                .delete()
                .eq('user_id', currentUser.id);
            
            if (cartError) {
                console.error('Error clearing cart:', cartError);
            }
            
            // Update local state
            cart = [];
            updateCartUI();
            
            showToast('Order placed successfully!', 'success');
            showPage('orders');
        }

        // Service Request Functions
        async function submitServiceRequest(formData) {
            if (!currentUser) {
                showToast('Please sign in to request a service', 'error');
                showPage('signin');
                return;
            }
            
            const payload = {
                user_id: currentUser.id,
                service_id: parseInt(formData.service_id),
                device_brand: formData.brand,
                device_model: formData.model,
                issue_details: formData.issue,
                pickup_address: formData.address,
                phone: formData.phone,
                preferred_date: formData.date
            };
            
            const { error } = await supabase
                .from('service_requests')
                .insert(payload);
            
            if (error) {
                showToast('Error submitting service request', 'error');
                console.error(error);
                return;
            }
            
            showToast('Service request submitted successfully!', 'success');
            document.getElementById('service-request-form').reset();
            
            // Reload service requests
            loadServiceRequests();
        }

        // Admin Functions
        async function updateOrderStatus(orderId, status) {
            const { error } = await supabase
                .from('orders')
                .update({ status })
                .eq('id', orderId);
            
            if (error) {
                showToast('Error updating order status', 'error');
                console.error(error);
                return;
            }
            
            showToast('Order status updated', 'success');
        }

        async function updateServiceRequestStatus(requestId, status) {
            const { error } = await supabase
                .from('service_requests')
                .update({ status })
                .eq('id', requestId);
            
            if (error) {
                showToast('Error updating service request status', 'error');
                console.error(error);
                return;
            }
            
            showToast('Service request status updated', 'success');
        }

        // Utility Functions
        function showToast(message, type = 'info') {
            const toast = document.getElementById('toast');
            toast.textContent = message;
            toast.className = `toast ${type} show`;
            
            // Add icon based on type
            let icon = 'info';
            if (type === 'success') icon = 'check-circle';
            if (type === 'error') icon = 'alert-circle';
            
            toast.innerHTML = `
                <i data-lucide="${icon}" class="w-5 h-5"></i>
                <span>${message}</span>
            `;
            
            lucide.createIcons();
            
            // Hide after 3 seconds
            setTimeout(() => {
                toast.classList.remove('show');
            }, 3000);
        }

        function setupEventListeners() {
            // Auth forms
            document.getElementById('signup-form').addEventListener('submit', async (e) => {
                e.preventDefault();
                const email = document.getElementById('signup-email').value;
                const password = document.getElementById('signup-password').value;
                const confirm = document.getElementById('signup-confirm').value;
                const fullName = document.getElementById('signup-name').value;
                const phone = document.getElementById('signup-phone').value;
                
                if (password !== confirm) {
                    showToast('Passwords do not match', 'error');
                    return;
                }
                
                await signUp(email, password, fullName, phone);
            });
            
            document.getElementById('signin-form').addEventListener('submit', async (e) => {
                e.preventDefault();
                const email = document.getElementById('signin-email').value;
                const password = document.getElementById('signin-password').value;
                
                await signIn(email, password);
            });
            
            // Service request form
            document.getElementById('service-request-form').addEventListener('submit', async (e) => {
                e.preventDefault();
                const formData = {
                    service_id: document.getElementById('service').value,
                    brand: document.getElementById('brand').value,
                    model: document.getElementById('model').value,
                    issue: document.getElementById('issue').value,
                    address: document.getElementById('address').value,
                    phone: document.getElementById('phone').value,
                    date: document.getElementById('date').value
                };
                
                await submitServiceRequest(formData);
            });
            
            // Checkout button
            document.getElementById('checkout-btn').addEventListener('click', checkout);
            
            // Admin tabs
            document.getElementById('admin-products-tab').addEventListener('click', () => {
                switchAdminTab('products');
            });
            
            document.getElementById('admin-services-tab').addEventListener('click', () => {
                switchAdminTab('services');
            });
            
            document.getElementById('admin-orders-tab').addEventListener('click', () => {
                switchAdminTab('orders');
            });
            
            document.getElementById('admin-requests-tab').addEventListener('click', () => {
                switchAdminTab('requests');
            });
            
            // Search and filter
            const searchInput = document.getElementById('search-input');
            const categoryFilter = document.getElementById('category-filter');
            const sortBy = document.getElementById('sort-by');
            
            if (searchInput) {
                searchInput.addEventListener('input', filterProducts);
            }
            
            if (categoryFilter) {
                categoryFilter.addEventListener('change', filterProducts);
            }
            
            if (sortBy) {
                sortBy.addEventListener('change', filterProducts);
            }
        }

        function switchAdminTab(tab) {
            // Update tab buttons
            document.querySelectorAll('[id$="-tab"]').forEach(button => {
                button.classList.remove('bg-primary-600', 'text-white');
                button.classList.add('bg-gray-200', 'text-gray-700');
            });
            
            document.getElementById(`admin-${tab}-tab`).classList.remove('bg-gray-200', 'text-gray-700');
            document.getElementById(`admin-${tab}-tab`).classList.add('bg-primary-600', 'text-white');
            
            // Show selected section
            document.querySelectorAll('.admin-section').forEach(section => {
                section.classList.add('hidden');
            });
            
            document.getElementById(`admin-${tab}`).classList.remove('hidden');
        }

        function filterProducts() {
            const searchTerm = document.getElementById('search-input').value.toLowerCase();
            const category = document.getElementById('category-filter').value;
            const sortBy = document.getElementById('sort-by').value;
            
            let filtered = [...products];
            
            // Apply search filter
            if (searchTerm) {
                filtered = filtered.filter(product => 
                    product.name.toLowerCase().includes(searchTerm) ||
                    product.brand.toLowerCase().includes(searchTerm) ||
                    product.category.toLowerCase().includes(searchTerm)
                );
            }
            
            // Apply category filter
            if (category) {
                filtered = filtered.filter(product => product.category === category);
            }
            
            // Apply sorting
            switch (sortBy) {
                case 'price-low':
                    filtered.sort((a, b) => a.price - b.price);
                    break;
                case 'price-high':
                    filtered.sort((a, b) => b.price - a.price);
                    break;
                case 'newest':
                default:
                    filtered.sort((a, b) => new Date(b.created_at) - new Date(a.created_at));
                    break;
            }
            
            // Render filtered products
            const container = document.getElementById('products-grid');
            if (!container) return;
            
            container.innerHTML = filtered.map(product => `
                <div class="bg-white rounded-2xl overflow-hidden shadow-sm hover:shadow-md transition">
                    <div class="h-48 bg-gray-200 overflow-hidden">
                        <img src="${product.thumbnail_url || 'https://via.placeholder.com/300'}" alt="${product.name}" class="w-full h-full object-cover">
                    </div>
                    <div class="p-4">
                        <div class="flex justify-between items-start mb-2">
                            <h3 class="font-semibold text-gray-800">${product.name}</h3>
                            ${product.stock > 0 ? 
                                `<span class="text-xs bg-green-100 text-green-800 px-2 py-1 rounded-full">In Stock</span>` : 
                                `<span class="text-xs bg-red-100 text-red-800 px-2 py-1 rounded-full">Out of Stock</span>`
                            }
                        </div>
                        <p class="text-sm text-gray-600 mb-4">${product.brand} â€¢ ${product.category}</p>
                        <div class="flex items-center justify-between">
                            <div>
                                <span class="text-lg font-bold text-gray-800">â‚¹${product.price}</span>
                                ${product.mrp && product.mrp > product.price ? 
                                    `<span class="text-sm text-gray-500 line-through ml-2">â‚¹${product.mrp}</span>` : ''
                                }
                            </div>
                            <button onclick="addToCart(${product.id})" ${product.stock === 0 ? 'disabled' : ''} 
                                class="p-2 bg-primary-100 text-primary-700 rounded-lg hover:bg-primary-200 transition ${product.stock === 0 ? 'opacity-50 cursor-not-allowed' : ''}">
                                <i data-lucide="shopping-cart" class="w-5 h-5"></i>
                            </button>
                        </div>
                    </div>
                </div>
            `).join('');
            
            lucide.createIcons();
        }

        // Placeholder functions for admin actions
        function editProduct(id) {
            showToast('Edit product functionality would open a form', 'info');
        }

        function deleteProduct(id) {
            if (confirm('Are you sure you want to delete this product?')) {
                showToast('Product would be deleted', 'info');
            }
        }

        function editService(id) {
            showToast('Edit service functionality would open a form', 'info');
        }

        function deleteService(id) {
            if (confirm('Are you sure you want to delete this service?')) {
                showToast('Service would be deleted', 'info');
            }
        }
    </script>
</body>
</html>